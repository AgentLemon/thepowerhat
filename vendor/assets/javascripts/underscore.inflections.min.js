(function(){var e,t,n,r=function(e,t){return function(){return e.apply(t,arguments)}},i=[].slice;e=function(){function e(){this.apply_inflections=r(this.apply_inflections,this);this.titleize=r(this.titleize,this);this.humanize=r(this.humanize,this);this.underscore=r(this.underscore,this);this.camelize=r(this.camelize,this);this.singularize=r(this.singularize,this);this.pluralize=r(this.pluralize,this);this.clearInflections=r(this.clearInflections,this);this.human=r(this.human,this);this.uncountable=r(this.uncountable,this);this.irregular=r(this.irregular,this);this.singular=r(this.singular,this);this.plural=r(this.plural,this);this.acronym=r(this.acronym,this);this.applyDefaultPlurals=r(this.applyDefaultPlurals,this);this.applyDefaultUncountables=r(this.applyDefaultUncountables,this);this.applyDefaultRules=r(this.applyDefaultRules,this);this.plurals=[];this.singulars=[];this.uncountables=[];this.humans=[];this.acronyms={};this.applyDefaultRules()}e.prototype.defaultUncountables=["equipment","information","rice","money","species","series","fish","sheep","jeans","moose","deer","news","music"];e.prototype.defaultPluralRules=[[/$/,"s"],[/s$/i,"s"],[/^(ax|test)is$/i,"$1es"],[/(octop|vir)us$/i,"$1i"],[/(octop|vir)i$/i,"$1i"],[/(alias|status)$/i,"$1es"],[/(bu)s$/i,"$1ses"],[/(buffal|tomat)o$/i,"$1oes"],[/([ti])um$/i,"$1a"],[/([ti])a$/i,"$1a"],[/sis$/i,"ses"],[/(?:([^f])fe|([lr])f)$/i,"$1$2ves"],[/(hive)$/i,"$1s"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/(x|ch|ss|sh)$/i,"$1es"],[/(matr|vert|ind)(?:ix|ex)$/i,"$1ices"],[/(m|l)ouse$/i,"$1ice"],[/(m|l)ice$/i,"$1ice"],[/^(ox)$/i,"$1en"],[/^(oxen)$/i,"$1"],[/(quiz)$/i,"$1zes"]];e.prototype.defaultSingularRules=[[/s$/i,""],[/(ss)$/i,"$1"],[/(n)ews$/i,"$1ews"],[/([ti])a$/i,"$1um"],[/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)(sis|ses)$/i,"$1$2sis"],[/(^analy)(sis|ses)$/i,"$1sis"],[/([^f])ves$/i,"$1fe"],[/(hive)s$/i,"$1"],[/(tive)s$/i,"$1"],[/([lr])ves$/i,"$1f"],[/([^aeiouy]|qu)ies$/i,"$1y"],[/(s)eries$/i,"$1eries"],[/(m)ovies$/i,"$1ovie"],[/(x|ch|ss|sh)es$/i,"$1"],[/(m|l)ice$/i,"$1ouse"],[/(bus)(es)?$/i,"$1"],[/(o)es$/i,"$1"],[/(shoe)s$/i,"$1"],[/(cris|test)(is|es)$/i,"$1is"],[/^(a)x[ie]s$/i,"$1xis"],[/(octop|vir)(us|i)$/i,"$1us"],[/(alias|status)(es)?$/i,"$1"],[/^(ox)en/i,"$1"],[/(vert|ind)ices$/i,"$1ex"],[/(matr)ices$/i,"$1ix"],[/(quiz)zes$/i,"$1"],[/(database)s$/i,"$1"]];e.prototype.defaultIrregularRules=[["person","people"],["man","men"],["child","children"],["sex","sexes"],["move","moves"],["cow","kine"],["zombie","zombies"]];e.prototype.defaultHumanRules=[];e.prototype.applyDefaultRules=function(){this.applyDefaultUncountables();this.applyDefaultPlurals();this.applyDefaultSingulars();return this.applyDefaultIrregulars()};e.prototype.applyDefaultUncountables=function(){return this.uncountable(this.defaultUncountables)};e.prototype.applyDefaultPlurals=function(){var e=this;return n.each(this.defaultPluralRules,function(t){var n,r;r=t[0],n=t[1];return e.plural(r,n)})};e.prototype.applyDefaultSingulars=function(){var e=this;return n.each(this.defaultSingularRules,function(t){var n,r;r=t[0],n=t[1];return e.singular(r,n)})};e.prototype.applyDefaultIrregulars=function(){var e=this;return n.each(this.defaultIrregularRules,function(t){var n,r;r=t[0],n=t[1];return e.irregular(r,n)})};e.prototype.acronym=function(e){this.acronyms[e.toLowerCase()]=e;return this.acronym_matchers=n.values(this.acronyms).join("|")};e.prototype.plural=function(e,t){if(typeof e==="string"){delete this.uncountables[n.indexOf(this.uncountables,e)]}delete this.uncountables[n.indexOf(this.uncountables,t)];return this.plurals.unshift([e,t])};e.prototype.singular=function(e,t){if(typeof e==="string"){delete this.uncountables[n.indexOf(this.uncountables,e)]}delete this.uncountables[n.indexOf(this.uncountables,t)];return this.singulars.unshift([e,t])};e.prototype.irregular=function(e,t){delete this.uncountables[n.indexOf(this.uncountables,e)];delete this.uncountables[n.indexOf(this.uncountables,t)];if(e.substring(0,1).toUpperCase()===t.substring(0,1).toUpperCase()){this.plural(new RegExp("("+e.substring(0,1)+")"+e.substring(1,t.length)+"$","i"),"$1"+t.substring(1,t.length));this.plural(new RegExp("("+t.substring(0,1)+")"+t.substring(1,t.length)+"$","i"),"$1"+t.substring(1,t.length));return this.singular(new RegExp("("+t.substring(0,1)+")"+t.substring(1,t.length)+"$","i"),"$1"+e.substring(1,t.length))}else{this.plural(new RegExp(""+e.substring(0,1)+e.substring(1,t.length)+"$","i"),t.substring(0,1)+t.substring(1,t.length));this.plural(new RegExp(""+e.substring(0,1)+e.substring(1,t.length)+"$","i"),t.substring(0,1)+t.substring(1,t.length));this.plural(new RegExp(""+t.substring(0,1)+t.substring(1,t.length)+"$","i"),t.substring(0,1)+t.substring(1,t.length));this.plural(new RegExp(""+t.substring(0,1)+t.substring(1,t.length)+"$","i"),t.substring(0,1)+t.substring(1,t.length));this.singular(new RegExp(""+t.substring(0,1)+t.substring(1,t.length)+"$","i"),e.substring(0,1)+e.substring(1,t.length));return this.singular(new RegExp(""+t.substring(0,1)+t.substring(1,t.length)+"$","i"),e.substring(0,1)+e.substring(1,t.length))}};e.prototype.uncountable=function(){var e;e=1<=arguments.length?i.call(arguments,0):[];this.uncountables.push(e);return this.uncountables=n.flatten(this.uncountables)};e.prototype.human=function(e,t){return this.humans.unshift([e,t])};e.prototype.clearInflections=function(e){if(e==null){e="all"}return this[e]=[]};e.prototype.pluralize=function(e,t,r){var i,s;if(r==null){r={}}r=n.extend({plural:void 0,showNumber:true},r);if(t!==void 0){i="";if(r.showNumber===true){i+=""+(t!=null?t:0)+" "}return i+=t===1||(t!=null?typeof t.toString==="function"?t.toString().match(/^1(\.0+)?$/):void 0:void 0)?e:(s=r.plural)!=null?s:this.pluralize(e)}else{return this.apply_inflections(e,this.plurals)}};e.prototype.singularize=function(e){return this.apply_inflections(e,this.singulars)};e.prototype.camelize=function(e,t){var r=this;if(t==null){t=true}if(t){e=e.replace(/^[a-z\d]*/,function(e){return r.acronyms[e]||n.capitalize(e)})}else{e=e.replace(RegExp("^(?:"+this.acronym_matchers+"(?=\\b|[A-Z_])|\\w)"),function(e){return e.toLowerCase()})}return e=e.replace(/(?:_|(\/))([a-z\d]*)/gi,function(e,t,i,s,o){t||(t="");return""+t+(r.acronyms[i]||n.capitalize(i))})};e.prototype.underscore=function(e){var t;t=e;t=t.replace(RegExp("(?:([A-Za-z\\d])|^)("+this.acronym_matchers+")(?=\\b|[^a-z])","g"),function(e,t,n){return""+(t||"")+(t?"_":"")+n.toLowerCase()});t=t.replace(/([A-Z\d]+)([A-Z][a-z])/g,"$1_$2");t=t.replace(/([a-z\d])([A-Z])/g,"$1_$2");t=t.replace("-","_");return t=t.toLowerCase()};e.prototype.humanize=function(e){var t,r,i,s,o,u,a,f=this;s=e;a=this.humans;for(o=0,u=a.length;o<u;o++){t=a[o];i=t[0];r=t[1];if(i.test!=null&&i.test(s)||i.indexOf!=null&&s.indexOf(i)>=0){s=s.replace(i,r);break}}s=s.replace(/_id$/g,"");s=s.replace(/_/g," ");s=s.replace(/([a-z\d]*)/gi,function(e){return f.acronyms[e]||e.toLowerCase()});return s=n.trim(s).replace(/^\w/g,function(e){return e.toUpperCase()})};e.prototype.titleize=function(e){return this.humanize(this.underscore(e)).replace(/([\sÂ¿]+)([a-z])/g,function(e,t,n,r,i){return e.replace(n,n.toUpperCase())})};e.prototype.apply_inflections=function(e,t){var r,i,s,o,u,a,f;if(!e){return e}else{o=e;i=o.toLowerCase().match(/\b\w+$/);if(i&&n.indexOf(this.uncountables,i[0])!==-1){return o}else{for(a=0,f=t.length;a<f;a++){u=t[a];s=u[0],r=u[1];if(o.match(s)){o=o.replace(s,r);break}}return o}}};return e}();t=typeof exports!=="undefined"&&exports!==null?exports:this;n=t._||require("underscore");if(typeof require!=="undefined"&&require!==null){n.str=require("underscore.string");n.mixin(n.str.exports());n.str.include("Underscore.string","string")}else{n.mixin(n.str.exports())}if(typeof exports==="undefined"){n.mixin(new e)}else{module.exports=new e}}).call(this)
